/***************************************************************************
*
*                      Pollex Mobile Platform
*
* Copyright (c) 2004 by Pollex Mobile Software Co., Ltd. 
*                       All Rights Reserved 
*
* Module   : 
*
* Purpose  : 
*
\**************************************************************************/
#include "ABGlobal.h"

int AB_Compare_Name(PVOID index1, PVOID index2);
int AB_Compare_Tel(PVOID index1, PVOID index2);
int AB_Compare_Email(PVOID index1, PVOID index2);
int AB_Compare_ID(PVOID index1, PVOID index2);
char* AB_GetNameString(PVOID pMemory);
char* AB_GetTelEmailString(PVOID pMemory);

int HalfComp(PVOID* Array, int start, int end, int index, CMPFUNC cmpf);

CMPFUNC g_CmpFunc[] = 
{
    AB_Compare_Name,
    AB_Compare_Tel,
    AB_Compare_Email,
    AB_Compare_ID,
    NULL,
};

const char AllPY[][7] =
{
	"a",
	"ai",
	"an",
	"ang",
	"ao",
	"ba",
	"bai",
	"ban",
	"bang",
	"bao",
	"bei",
	"ben",
	"beng",
	"bi",
	"bian",
	"biao",
	"bie",
	"bin",
	"bing",
	"bo",
	"bu",
	"ca",
	"cai",
	"can",
	"cang",
	"cao",
	"ce",
	"cen",
	"ceng",
	"ch",
	"cha",
	"chai",
	"chan",
	"chang",
	"chao",
	"che",
	"chen",
	"cheng",
	"chi",
	"chong",
	"chou",
	"chu",
	"chuai",
	"chuan",
	"chuang",
	"chui",
	"chun",
	"chuo",
	"ci",
	"cong",
	"cou",
	"cu",
	"cuan",
	"cui",
	"cun",
	"cuo",
	"da",
	"dai",
	"dan",
	"dang",
	"dao",
	"de",
	"deng",
	"di",
	"dia",
	"dian",
	"diao",
	"die",
	"ding",
	"diu",
	"dong",
	"dou",
	"du",
	"duan",
	"dui",
	"dun",
	"duo",
	"e",
	"ei",
	"en",
	"er",
	"fa",
	"fan",
	"fang",
	"fei",
	"fen",
	"feng",
	"fo",
	"fou",
	"fu",
	"ga",
	"gai",
	"gan",
	"gang",
	"gao",
	"ge",
	"gei",
	"gen",
	"geng",
	"gong",
	"gou",
	"gu",
	"gua",
	"guai",
	"guan",
	"guang",
	"gui",
	"gun",
	"guo",
	"ha",
	"hai",
	"han",
	"hang",
	"hao",
	"he",
	"hei",
	"hen",
	"heng",
	"hng",
	"hong",
	"hou",
	"hu",
	"hua",
	"huai",
	"huan",
	"huang",
	"hui",
	"hun",
	"huo",
	"ji",
	"jia",
	"jian",
	"jiang",
	"jiao",
	"jie",
	"jin",
	"jing",
	"jiong",
	"jiu",
	"ju",
	"juan",
	"jue",
	"jun",
	"ka",
	"kai",
	"kan",
	"kang",
	"kao",
	"ke",
	"ken",
	"keng",
	"kong",
	"kou",
	"ku",
	"kua",
	"kuai",
	"kuan",
	"kuang",
	"kui",
	"kun",
	"kuo",
	"la",
	"lai",
	"lan",
	"lang",
	"lao",
	"le",
	"lei",
	"leng",
	"li",
	"lia",
	"lian",
	"liang",
	"liao",
	"lie",
	"lin",
	"ling",
	"liu",
	"lo",
	"long",
	"lou",
	"lu",
	"lv",
	"luan",
	"lue",
	"lun",
	"luo",
	"ma",
	"mai",
	"man",
	"mang",
	"mao",
	"me",
	"mei",
	"men",
	"meng",
	"mi",
	"mian",
	"miao",
	"mie",
	"min",
	"ming",
	"miu",
	"mo",
	"mou",
	"mu",
	"na",
	"nai",
	"nan",
	"nang",
	"nao",
	"ne",
	"nei",
	"nen",
	"neng",
	"ni",
	"nian",
	"niang",
	"niao",
	"nie",
	"nin",
	"ning",
	"niu",
	"nong",
	"nou",
	"nu",
	"nv",
	"nuan",
	"nue",
	"nuo",
	"o",
	"ou",
	"pa",
	"pai",
	"pan",
	"pang",
	"pao",
	"pei",
	"pen",
	"peng",
	"pi",
	"pian",
	"piao",
	"pie",
	"pin",
	"ping",
	"po",
	"pou",
	"pu",
	"qi",
	"qia",
	"qian",
	"qiang",
	"qiao",
	"qie",
	"qin",
	"qing",
	"qiong",
	"qiu",
	"qu",
	"quan",
	"que",
	"qun",
	"ran",
	"rang",
	"rao",
	"re",
	"ren",
	"reng",
	"ri",
	"rong",
	"rou",
	"ru",
	"ruan",
	"rui",
	"run",
	"ruo",
	"sa",
	"sai",
	"san",
	"sang",
	"sao",
	"se",
	"sen",
	"seng",
	"sh",
	"sha",
	"shai",
	"shan",
	"shang",
	"shao",
	"she",
	"shei",
	"shen",
	"sheng",
	"shi",
	"shou",
	"shu",
	"shua",
	"shuai",
	"shuan",
	"shuang",
	"shui",
	"shun",
	"shuo",
	"si",
	"song",
	"sou",
	"su",
	"suan",
	"sui",
	"sun",
	"suo",
	"ta",
	"tai",
	"tan",
	"tang",
	"tao",
	"te",
	"teng",
	"ti",
	"tian",
	"tiao",
	"tie",
	"ting",
	"tong",
	"tou",
	"tu",
	"tuan",
	"tui",
	"tun",
	"tuo",
	"wa",
	"wai",
	"wan",
	"wang",
	"wei",
	"wen",
	"weng",
	"wo",
	"wu",
	"xi",
	"xia",
	"xian",
	"xiang",
	"xiao",
	"xie",
	"xin",
	"xing",
	"xiong",
	"xiu",
	"xu",
	"xuan",
	"xue",
	"xun",
	"ya",
	"yan",
	"yang",
	"yao",
	"ye",
	"yi",
	"yin",
	"ying",
	"yo",
	"yong",
	"you",
	"yu",
	"yuan",
	"yue",
	"yun",
	"za",
	"zai",
	"zan",
	"zang",
	"zao",
	"ze",
	"zei",
	"zen",
	"zeng",
	"zh",
	"zha",
	"zhai",
	"zhan",
	"zhang",
	"zhao",
	"zhe",
	"zhei",
	"zhen",
	"zheng",
	"zhi",
	"zhong",
	"zhou",
	"zhu",
	"zhua",
	"zhuai",
	"zhuan",
	"zhuang",
	"zhui",
	"zhun",
	"zhuo",
	"zi",
	"zong",
	"zou",
	"zu",
	"zuan",
	"zui",
	"zun",
	"zuo",
};

const WORD PYIndex[72][94] =		//加入了对多音字的判断，字音定为姓氏音或常用音
{
	{ 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 4, 4, 4, 4, 4, 4, 4, 4, 4, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 232, 5, 5, 5, 5, 6, 6, 6, 6, 6, 6, 6, 6, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 9, 9, 9, 9, 19 },
	{ 19, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 11, 11, 11, 11, 12, 12, 12, 12, 12, 12, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 14, 14, 14, 14, 193, 14, 14, 14, 14, 14, 14, 14, 15, 15, 15, 15, 16, 16, 16, 16, 17, 17, 17, 17, 17, 17, 18, 18, 18, 18, 18, 18, 18 },
	{ 18, 18, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 246, 19, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 21, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 23, 23, 23, 23, 23, 23, 23, 24, 24, 24, 24, 373, 25, 25, 25, 25, 25, 26, 26, 26, 26, 26, 28, 28, 30, 30, 30, 30, 380, 30, 30, 30, 30, 30, 30, 31, 31, 31, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 33, 33 },
	{ 33, 33, 33, 383, 33, 33, 33, 33, 33, 33, 33, 34, 34, 34, 384, 34, 34, 34, 34, 34, 35, 35, 35, 35, 35, 35, 36, 36, 36, 36, 36, 36, 36, 36, 36, 36, 37, 37, 37, 37, 37, 37, 37, 37, 37, 37, 37, 37, 37, 37, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 39, 39, 39, 39, 39, 40, 40, 40, 40, 40, 40, 40, 258, 40, 40, 40, 40, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41 },
	{ 41, 41, 41, 41, 41, 41, 42, 43, 43, 43, 43, 43, 43, 43, 44, 44, 396, 44, 44, 44, 45, 45, 45, 45, 45, 46, 46, 46, 46, 46, 46, 46, 47, 47, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 49, 49, 49, 49, 49, 49, 50, 51, 51, 51, 51, 52, 52, 52, 53, 53, 53, 53, 53, 53, 53, 53, 54, 54, 54, 55, 55, 55, 55, 55, 55, 56, 56, 56, 56, 56, 56, 57, 57, 57, 57, 57, 57, 57, 57, 57, 57, 57 },
	{ 57, 58, 58, 58, 288, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 59, 59, 59, 59, 59, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 61, 61, 61, 62, 62, 62, 62, 62, 62, 62, 63, 63, 63, 63, 63, 63, 63, 63, 381, 63, 63, 63, 63, 63, 63, 63, 63, 63, 63, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 66, 66, 66, 66, 66, 66, 66, 66, 66, 67, 67, 67, 67, 67, 67, 67 },
	{ 68, 68, 68, 68, 68, 68, 68, 68, 68, 69, 70, 70, 70, 70, 70, 70, 325, 70, 70, 70, 71, 71, 71, 71, 71, 71, 71, 72, 72, 72, 72, 72, 72, 72, 72, 72, 72, 72, 72, 72, 72, 72, 73, 73, 73, 73, 73, 73, 74, 74, 74, 74, 75, 75, 75, 75, 41, 330, 75, 75, 75, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 76, 77, 77, 77, 77, 77, 77, 77, 77, 77, 77, 77, 77, 77, 79, 80, 80, 80, 80, 80, 80, 80 },
	{ 80, 81, 81, 81, 81, 81, 81, 81, 81, 82, 82, 234, 82, 82, 82, 82, 82, 82, 82, 82, 82, 82, 82, 82, 82, 82, 83, 83, 83, 83, 83, 83, 83, 83, 83, 83, 83, 84, 84, 84, 84, 84, 84, 84, 84, 84, 84, 84, 84, 85, 85, 85, 85, 85, 85, 85, 85, 85, 85, 85, 85, 85, 85, 85, 86, 86, 86, 86, 86, 86, 86, 86, 86, 86, 86, 86, 86, 86, 86, 87, 240, 89, 89, 89, 89, 89, 89, 89, 89, 89, 89, 89, 89, 89 },
	{ 89, 89, 89, 89, 89, 89, 89, 89, 89, 89, 89, 89, 89, 89, 89, 89, 89, 89, 89, 89, 89, 89, 89, 89, 89, 89, 89, 89, 89, 89, 89, 65535, 90, 90, 91, 91, 91, 91, 95, 91, 92, 92, 92, 92, 92, 92, 92, 92, 92, 92, 92, 93, 93, 93, 93, 93, 93, 93, 93, 93, 94, 94, 94, 94, 94, 94, 94, 113, 94, 94, 95, 95, 95, 95, 95, 95, 95, 95, 95, 95, 95, 109, 95, 95, 95, 95, 95, 96, 97, 97, 98, 98, 98, 98 },
	{ 98, 98, 98, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 100, 100, 100, 100, 100, 100, 100, 100, 100, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 101, 102, 102, 102, 102, 102, 102, 103, 103, 103, 104, 104, 104, 104, 104, 104, 104, 104, 104, 104, 104, 105, 105, 105, 106, 106, 106, 106, 106, 106, 106, 106, 106, 106, 106, 106, 106, 106, 106, 106, 107, 107, 107, 108, 108, 108, 108, 108, 108, 109 },
	{ 110, 110, 110, 110, 110, 110, 110, 111, 111, 111, 111, 111, 111, 111, 111, 111, 111, 111, 111, 111, 111, 111, 111, 111, 111, 111, 112, 112, 112, 113, 113, 113, 113, 113, 113, 113, 113, 113, 114, 114, 114, 114, 114, 114, 114, 114, 114, 114, 114, 114, 114, 114, 114, 114, 114, 114, 115, 115, 116, 116, 116, 116, 117, 117, 117, 117, 117, 119, 119, 119, 119, 119, 119, 119, 119, 119, 120, 120, 120, 120, 120, 120, 120, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121 },
	{ 121, 121, 121, 121, 121, 121, 121, 122, 122, 122, 122, 122, 122, 122, 122, 122, 123, 123, 123, 123, 123, 124, 124, 124, 124, 124, 124, 124, 124, 124, 124, 124, 124, 124, 124, 125, 125, 125, 125, 125, 125, 125, 125, 125, 125, 125, 125, 125, 125, 126, 126, 126, 126, 126, 126, 126, 126, 126, 126, 126, 126, 126, 126, 126, 126, 126, 126, 126, 126, 126, 127, 127, 127, 127, 127, 127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 129, 129, 129, 129, 129, 129, 129, 129 },
	{ 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 381, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 130, 130, 130, 130, 130, 130, 130, 130, 130, 130, 130, 130, 130, 130, 130, 130, 130, 131, 131, 131, 131, 131, 131, 131, 131, 131, 131, 131, 131, 131, 131, 131, 131, 131, 131, 131, 131, 131, 131, 131, 131, 131, 131, 131, 131, 131, 131, 131, 131 },
	{ 131, 131, 131, 131, 131, 131, 131, 131, 132, 132, 132, 132, 132, 132, 132, 132, 132, 132, 132, 132, 344, 133, 133, 133, 133, 133, 133, 133, 133, 133, 133, 133, 133, 133, 133, 133, 133, 133, 133, 133, 133, 133, 133, 133, 133, 133, 133, 133, 133, 134, 134, 134, 134, 134, 134, 134, 134, 134, 139, 134, 134, 134, 134, 134, 134, 346, 134, 134, 134, 134, 134, 134, 134, 134, 134, 134, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135 },
	{ 135, 136, 136, 136, 136, 136, 136, 136, 136, 136, 136, 136, 136, 136, 136, 136, 136, 136, 136, 136, 136, 136, 136, 136, 136, 136, 136, 137, 137, 138, 138, 138, 138, 138, 138, 138, 138, 138, 138, 138, 138, 138, 138, 138, 138, 138, 139, 139, 139, 139, 139, 139, 139, 139, 139, 139, 139, 139, 139, 139, 139, 139, 139, 139, 139, 139, 139, 139, 139, 139, 139, 140, 140, 140, 140, 140, 140, 140, 141, 141, 141, 141, 141, 141, 141, 141, 141, 141, 142, 142, 142, 142, 142, 142 },
	{ 142, 142, 142, 142, 142, 143, 143, 143, 143, 144, 144, 144, 144, 144, 145, 145, 145, 145, 145, 145, 146, 146, 146, 146, 146, 146, 146, 147, 147, 147, 147, 148, 148, 148, 148, 148, 148, 148, 148, 148, 148, 148, 148, 148, 148, 148, 149, 149, 149, 149, 150, 112, 151, 151, 151, 151, 152, 152, 152, 152, 153, 153, 153, 153, 153, 153, 153, 154, 154, 154, 154, 154, 155, 155, 155, 155, 156, 156, 157, 157, 157, 157, 157, 157, 157, 157, 158, 158, 158, 158, 158, 158, 158, 158 },
	{ 158, 158, 158, 159, 159, 159, 159, 160, 160, 160, 160, 161, 161, 161, 161, 161, 161, 161, 162, 162, 162, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 164, 164, 164, 164, 164, 164, 164, 165, 165, 165, 165, 165, 165, 165, 165, 165, 166, 368, 167, 167, 167, 167, 167, 167, 167, 167, 167, 167, 167, 168, 168, 168, 169, 169, 169, 169, 169, 169, 169, 169, 169, 169, 169, 169, 169, 169, 169, 169, 169, 169, 169, 169, 169, 169, 169, 169, 169, 169 },
	{ 169, 169, 169, 169, 169, 169, 169, 169, 172, 171, 171, 171, 171, 171, 171, 171, 171, 171, 171, 171, 171, 171, 171, 172, 172, 172, 172, 172, 172, 172, 172, 172, 172, 172, 173, 173, 173, 173, 173, 173, 173, 173, 173, 173, 173, 173, 173, 174, 174, 174, 174, 174, 175, 175, 175, 175, 175, 175, 175, 175, 175, 175, 175, 175, 176, 176, 176, 176, 176, 176, 176, 176, 176, 176, 176, 176, 176, 176, 177, 177, 177, 177, 177, 177, 177, 177, 177, 177, 177, 179, 179, 179, 179, 179 },
	{ 179, 179, 179, 179, 180, 180, 180, 180, 180, 180, 181, 181, 181, 181, 181, 181, 181, 181, 181, 181, 181, 181, 181, 181, 181, 181, 181, 181, 181, 181, 182, 182, 182, 182, 182, 182, 182, 182, 182, 182, 182, 299, 182, 182, 183, 183, 183, 183, 183, 183, 184, 184, 185, 185, 185, 185, 185, 185, 185, 186, 186, 186, 186, 186, 186, 186, 186, 186, 186, 186, 186, 187, 187, 187, 187, 187, 187, 187, 187, 187, 188, 188, 188, 188, 188, 203, 189, 189, 189, 189, 189, 189, 189, 189 },
	{ 189, 190, 190, 190, 195, 190, 190, 191, 191, 191, 191, 191, 191, 191, 191, 191, 191, 191, 191, 192, 193, 193, 193, 193, 193, 193, 203, 193, 193, 193, 193, 193, 193, 193, 193, 193, 194, 194, 194, 195, 195, 195, 195, 195, 195, 195, 195, 196, 196, 196, 196, 196, 196, 196, 196, 196, 196, 196, 196, 196, 196, 197, 197, 197, 197, 197, 197, 197, 197, 197, 198, 198, 198, 198, 198, 198, 198, 198, 199, 199, 200, 200, 200, 200, 200, 200, 201, 201, 201, 201, 201, 201, 202, 203 },
	{ 203, 203, 203, 203, 203, 203, 203, 203, 203, 203, 203, 203, 203, 203, 203, 203, 204, 204, 204, 205, 205, 205, 205, 205, 205, 205, 205, 205, 205, 205, 205, 205, 205, 205, 206, 206, 211, 206, 206, 206, 206, 207, 207, 207, 207, 207, 208, 208, 208, 209, 210, 210, 210, 210, 210, 215, 212, 212, 213, 214, 215, 215, 215, 215, 215, 215, 215, 215, 215, 215, 215, 216, 216, 216, 216, 216, 216, 216, 217, 217, 218, 218, 219, 219, 219, 219, 219, 219, 219, 220, 221, 221, 221, 221 },
	{ 221, 221, 222, 222, 222, 222, 223, 223, 223, 223, 225, 225, 225, 226, 227, 228, 228, 229, 229, 229, 229, 230, 231, 231, 231, 231, 231, 231, 231, 232, 232, 232, 232, 232, 232, 233, 233, 233, 233, 233, 233, 234, 234, 234, 234, 234, 234, 234, 234, 235, 235, 235, 235, 235, 236, 236, 236, 236, 236, 236, 236, 237, 237, 237, 237, 237, 237, 237, 237, 237, 238, 238, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 240, 240, 240, 240, 240, 240, 240, 240 },
	{ 240, 240, 240, 240, 240, 240, 240, 240, 240, 241, 241, 241, 241, 242, 242, 242, 242, 243, 243, 244, 244, 244, 244, 244, 245, 245, 245, 245, 245, 245, 245, 245, 245, 246, 246, 246, 246, 246, 246, 246, 246, 247, 248, 248, 248, 248, 248, 248, 248, 248, 242, 248, 248, 248, 248, 248, 248, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 250 },
	{ 250, 250, 251, 251, 251, 251, 251, 251, 251, 251, 251, 251, 251, 251, 251, 251, 251, 251, 251, 251, 251, 251, 251, 251, 252, 252, 252, 252, 252, 252, 252, 252, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 254, 130, 254, 254, 254, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 256, 256, 256, 256, 256, 256, 256, 256, 256, 256, 256, 256, 256, 257, 257, 258, 258, 258, 258, 258, 258, 258, 258, 259, 231, 259, 259, 259, 259, 259, 259 },
	{ 259, 259, 259, 259, 259, 260, 260, 260, 260, 260, 260, 260, 260, 260, 260, 260, 261, 106, 261, 261, 261, 261, 261, 261, 262, 262, 263, 263, 263, 263, 264, 264, 264, 264, 264, 265, 265, 265, 266, 266, 267, 267, 267, 267, 267, 267, 267, 267, 267, 267, 268, 268, 269, 270, 270, 270, 270, 270, 270, 270, 270, 270, 270, 271, 271, 271, 272, 272, 272, 272, 272, 272, 272, 272, 272, 272, 273, 273, 274, 274, 274, 275, 275, 276, 276, 277, 277, 277, 278, 278, 278, 278, 279, 279 },
	{ 279, 279, 280, 280, 280, 281, 281, 281, 281, 282, 282, 282, 283, 284, 286, 286, 286, 286, 286, 286, 286, 286, 286, 287, 287, 288, 288, 288, 288, 288, 288, 288, 288, 288, 288, 288, 288, 288, 288, 288, 288, 289, 289, 289, 289, 289, 289, 289, 33, 290, 290, 290, 290, 290, 290, 290, 290, 290, 290, 290, 291, 291, 291, 291, 291, 291, 291, 291, 291, 291, 291, 291, 293, 293, 293, 293, 293, 293, 293, 293, 293, 293, 293, 293, 293, 293, 293, 293, 294, 294, 294, 294, 294, 294 },
	{ 348, 294, 294, 294, 294, 295, 295, 295, 295, 295, 295, 295, 295, 295, 295, 295, 295, 295, 295, 295, 295, 295, 295, 295, 295, 295, 295, 295, 295, 295, 295, 295, 295, 295, 295, 295, 295, 295, 295, 295, 295, 295, 295, 295, 295, 295, 295, 295, 295, 295, 295, 295, 296, 296, 296, 296, 296, 296, 296, 296, 296, 296, 297, 297, 297, 297, 297, 297, 297, 297, 297, 297, 297, 297, 297, 297, 297, 297, 297, 297, 297, 297, 297, 297, 297, 297, 297, 297, 297, 297, 297, 297, 297, 297 },
	{ 297, 298, 298, 299, 53, 299, 299, 300, 300, 301, 301, 301, 302, 302, 302, 302, 303, 303, 303, 303, 304, 304, 304, 304, 305, 305, 305, 305, 305, 305, 305, 305, 305, 305, 305, 305, 305, 305, 305, 305, 306, 306, 306, 306, 306, 306, 306, 306, 307, 307, 307, 307, 308, 308, 308, 308, 308, 308, 308, 308, 308, 350, 308, 308, 309, 309, 309, 310, 310, 310, 310, 310, 310, 310, 310, 310, 310, 310, 311, 311, 311, 312, 312, 312, 312, 312, 312, 312, 312, 313, 313, 313, 313, 313 },
	{ 313, 313, 313, 313, 314, 314, 314, 314, 314, 314, 314, 314, 314, 315, 315, 315, 315, 315, 315, 315, 315, 315, 315, 315, 315, 315, 315, 315, 315, 315, 315, 316, 316, 316, 316, 316, 316, 316, 316, 316, 316, 316, 316, 316, 317, 317, 317, 317, 317, 317, 317, 317, 317, 317, 317, 318, 319, 319, 319, 319, 320, 320, 320, 320, 320, 320, 320, 320, 320, 320, 320, 320, 320, 320, 320, 321, 321, 321, 321, 321, 321, 321, 321, 322, 322, 322, 322, 322, 323, 323, 323, 324, 324, 324 },
	{ 324, 324, 324, 324, 324, 324, 324, 325, 325, 325, 325, 325, 325, 325, 325, 325, 325, 325, 325, 325, 326, 326, 326, 326, 327, 327, 327, 327, 327, 327, 327, 327, 327, 327, 327, 328, 328, 329, 329, 329, 329, 329, 329, 330, 330, 330, 331, 331, 331, 331, 331, 331, 331, 331, 331, 331, 331, 332, 332, 332, 332, 332, 332, 332, 333, 333, 334, 334, 334, 334, 334, 334, 334, 334, 334, 334, 334, 334, 334, 334, 334, 334, 334, 335, 335, 335, 335, 335, 335, 335, 335, 335, 335, 336 },
	{ 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 366, 336, 336, 337, 337, 337, 337, 337, 337, 337, 337, 337, 337, 338, 338, 338, 393, 339, 339, 339, 339, 339, 339, 339, 339, 340, 340, 340, 340, 340, 340, 340, 340, 340, 340, 340, 340, 340, 340, 340, 340, 340, 340, 340, 340, 340, 340, 340, 340, 340, 340, 340, 340, 340, 341, 341, 341, 341, 341, 341, 341, 341, 341, 341, 341 },
	{ 341, 341, 341, 341, 341, 341, 341, 341, 341, 341, 341, 341, 341, 341, 341, 341, 341, 341, 341, 343, 129, 341, 341, 341, 342, 342, 342, 342, 342, 342, 342, 342, 342, 342, 286, 342, 342, 343, 343, 343, 343, 343, 343, 343, 343, 343, 343, 343, 343, 343, 343, 343, 343, 343, 343, 343, 343, 343, 343, 343, 343, 343, 343, 344, 344, 344, 344, 344, 344, 344, 344, 344, 344, 344, 344, 344, 344, 344, 344, 344, 344, 344, 344, 345, 345, 345, 345, 345, 345, 345, 345, 345, 345, 345 },
	{ 345, 345, 345, 345, 345, 345, 345, 346, 346, 346, 346, 346, 346, 346, 346, 346, 346, 346, 346, 346, 346, 346, 346, 346, 346, 346, 346, 346, 347, 347, 347, 347, 347, 347, 347, 347, 347, 347, 348, 348, 348, 348, 348, 348, 348, 348, 348, 348, 348, 348, 348, 348, 348, 349, 349, 349, 349, 349, 349, 349, 350, 350, 350, 350, 350, 350, 350, 350, 350, 351, 351, 351, 351, 351, 351, 351, 351, 351, 351, 351, 351, 351, 41, 351, 351, 351, 351, 351, 352, 352, 352, 352, 352, 352 },
	{ 352, 352, 352, 352, 353, 353, 353, 353, 353, 353, 354, 354, 354, 354, 354, 354, 354, 354, 354, 354, 354, 354, 354, 354, 355, 355, 355, 355, 355, 355, 355, 355, 355, 355, 355, 355, 355, 355, 355, 355, 356, 356, 356, 356, 356, 356, 356, 356, 356, 356, 356, 356, 356, 356, 356, 356, 356, 356, 356, 356, 356, 356, 356, 356, 356, 356, 356, 356, 356, 356, 356, 356, 356, 357, 357, 357, 357, 357, 357, 357, 357, 357, 357, 357, 357, 357, 357, 357, 357, 357, 358, 358, 358, 358 },
	{ 358, 358, 358, 358, 358, 358, 358, 358, 358, 358, 358, 359, 359, 359, 359, 359, 359, 359, 359, 359, 359, 359, 359, 359, 359, 359, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 361, 361, 361, 361, 361, 361, 361, 361, 361, 361, 361, 361, 361, 361, 361 },
	{ 361, 362, 362, 362, 362, 362, 362, 362, 362, 362, 362, 362, 362, 362, 362, 362, 362, 362, 362, 363, 364, 364, 364, 364, 364, 364, 364, 364, 364, 364, 364, 364, 364, 364, 364, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 366, 366, 366, 366, 366, 366, 366, 366, 366, 366, 366, 366, 366, 366, 366, 366, 366, 366, 366, 366, 366, 366, 366, 366, 366, 366, 366, 366, 366, 366, 366, 366, 366, 366, 366, 366, 366, 366, 366 },
	{ 366, 366, 366, 366, 366, 366, 367, 367, 367, 367, 367, 367, 367, 367, 367, 367, 369, 367, 367, 367, 367, 367, 367, 367, 367, 367, 368, 368, 368, 368, 358, 368, 368, 368, 368, 368, 369, 369, 369, 369, 369, 369, 369, 369, 369, 369, 369, 369, 370, 370, 370, 371, 371, 371, 371, 371, 371, 371, 372, 52, 372, 372, 373, 373, 373, 374, 374, 374, 374, 374, 374, 374, 374, 374, 374, 374, 374, 374, 374, 375, 375, 375, 375, 376, 377, 378, 378, 378, 378, 380, 380, 380, 380, 355 },
	{ 380, 380, 380, 380, 380, 370, 380, 380, 380, 381, 381, 381, 381, 381, 381, 382, 382, 382, 382, 382, 382, 382, 216, 382, 382, 382, 382, 382, 382, 382, 382, 382, 383, 383, 383, 383, 383, 383, 383, 383, 383, 383, 383, 383, 383, 383, 383, 384, 384, 384, 384, 384, 384, 384, 384, 384, 384, 385, 385, 385, 385, 385, 385, 385, 385, 385, 385, 387, 387, 387, 387, 387, 387, 387, 387, 387, 387, 387, 387, 387, 387, 387, 387, 388, 388, 388, 388, 388, 388, 388, 388, 388, 388, 388 },
	{ 387, 388, 388, 388, 389, 389, 389, 389, 389, 389, 389, 389, 389, 389, 389, 389, 389, 389, 389, 389, 389, 389, 389, 389, 389, 389, 389, 389, 389, 389, 389, 389, 389, 389, 389, 389, 389, 389, 389, 389, 389, 389, 389, 389, 389, 389, 389, 390, 390, 390, 390, 390, 390, 390, 390, 390, 390, 390, 391, 391, 391, 391, 391, 391, 391, 391, 391, 391, 391, 391, 391, 391, 392, 392, 392, 392, 392, 392, 392, 392, 392, 392, 392, 392, 392, 392, 392, 392, 392, 392, 392, 392, 392, 392 },
	{ 392, 392, 392, 392, 393, 384, 394, 395, 395, 395, 395, 395, 395, 396, 396, 396, 396, 396, 396, 396, 397, 397, 397, 397, 397, 397, 398, 398, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 399, 400, 400, 400, 400, 400, 400, 400, 400, 371, 400, 400, 400, 400, 400, 400, 401, 401, 401, 401, 401, 401, 401, 402, 402, 402, 402, 403, 403, 403, 403, 403, 403, 403, 403, 404, 404, 405, 405, 405, 405, 406, 406, 407, 407, 407, 380, 407, 407, 407, 407, 65535, 65535, 65535, 65535, 65535 },
	{ 41, 129, 340, 91, 216, 277, 240, 97, 37, 95, 210, 77, 65535, 366, 65535, 13, 331, 358, 358, 389, 63, 347, 361, 158, 366, 94, 317, 65535, 129, 207, 219, 129, 249, 196, 10, 282, 101, 375, 291, 55, 356, 141, 305, 359, 356, 65535, 246, 106, 158, 14, 375, 102, 365, 65535, 360, 337, 136, 153, 106, 144, 161, 129, 356, 334, 155, 242, 141, 253, 128, 360, 65535, 335, 65535, 68, 383, 166, 277, 360, 205, 267, 366, 240, 355, 332, 340, 33, 24, 146, 392, 221, 143, 365, 360, 100 },
	{ 325, 331, 215, 130, 129, 207, 365, 154, 145, 392, 360, 322, 31, 133, 223, 204, 40, 356, 169, 258, 169, 366, 245, 364, 305, 86, 251, 276, 233, 399, 297, 186, 339, 13, 320, 104, 151, 139, 85, 356, 346, 134, 336, 401, 180, 316, 17, 229, 38, 341, 136, 131, 133, 138, 396, 352, 58, 325, 330, 291, 251, 403, 368, 52, 63, 341, 354, 119, 108, 32, 158, 65535, 248, 119, 89, 89, 308, 305, 65535, 356, 19, 107, 191, 346, 183, 247, 18, 362, 186, 167, 65535, 121, 174, 343 },
	{ 306, 65535, 390, 201, 65535, 134, 119, 288, 231, 139, 211, 101, 114, 63, 384, 259, 360, 157, 167, 102, 134, 126, 293, 100, 260, 388, 127, 351, 253, 94, 157, 78, 402, 399, 336, 366, 293, 32, 310, 36, 131, 353, 359, 77, 366, 352, 2, 63, 400, 241, 203, 59, 308, 295, 196, 385, 131, 377, 253, 141, 356, 382, 36, 65535, 135, 65535, 340, 251, 136, 7, 65, 407, 240, 348, 91, 389, 219, 402, 45, 240, 336, 125, 158, 341, 111, 257, 157, 190, 340, 83, 18, 240, 10, 359 },
	{ 63, 314, 130, 389, 392, 155, 254, 124, 369, 169, 362, 94, 341, 89, 240, 315, 356, 140, 356, 361, 383, 246, 288, 402, 176, 86, 41, 124, 188, 259, 290, 114, 95, 195, 351, 346, 307, 346, 141, 65535, 65535, 59, 33, 305, 14, 11, 258, 11, 77, 81, 297, 129, 364, 114, 336, 340, 95, 387, 157, 240, 360, 169, 249, 7, 92, 179, 65, 181, 35, 63, 331, 215, 205, 4, 355, 67, 70, 144, 288, 289, 210, 91, 361, 37, 295, 108, 354, 174, 367, 389, 2, 360, 240, 216 },
	{ 239, 327, 281, 57, 153, 67, 361, 168, 120, 95, 367, 189, 364, 172, 38, 347, 240, 360, 65535, 133, 207, 72, 251, 129, 334, 349, 249, 344, 65535, 356, 369, 89, 129, 169, 77, 139, 13, 389, 274, 343, 33, 49, 255, 340, 251, 249, 288, 14, 392, 152, 360, 203, 92, 243, 179, 5, 205, 139, 263, 256, 38, 89, 176, 218, 361, 191, 362, 257, 200, 290, 251, 360, 265, 13, 400, 139, 325, 126, 392, 324, 253, 89, 267, 348, 260, 126, 354, 201, 129, 133, 39, 132, 186, 348 },
	{ 251, 97, 135, 188, 311, 119, 391, 145, 13, 295, 339, 365, 77, 193, 365, 169, 327, 343, 89, 310, 365, 63, 293, 334, 164, 362, 46, 136, 249, 341, 306, 135, 207, 249, 5, 297, 33, 323, 366, 124, 13, 89, 327, 58, 53, 356, 403, 59, 131, 334, 362, 101, 111, 250, 86, 293, 344, 336, 32, 144, 249, 158, 341, 77, 9, 232, 324, 180, 233, 352, 130, 387, 295, 272, 203, 79, 10, 338, 113, 129, 169, 8, 131, 304, 164, 362, 366, 308, 195, 71, 341, 171, 51, 175 },
	{ 259, 152, 351, 173, 126, 354, 141, 274, 405, 129, 195, 82, 249, 119, 346, 119, 336, 360, 338, 307, 13, 113, 314, 272, 354, 343, 94, 169, 128, 259, 117, 82, 219, 196, 65535, 360, 157, 171, 56, 360, 341, 373, 236, 365, 173, 90, 92, 65535, 194, 328, 36, 89, 234, 4, 134, 133, 372, 360, 182, 142, 321, 359, 1, 206, 129, 103, 6, 139, 247, 174, 251, 104, 67, 380, 355, 255, 366, 2, 352, 18, 158, 367, 297, 79, 42, 131, 304, 382, 229, 280, 186, 362, 389, 111 },
	{ 385, 346, 181, 406, 52, 92, 124, 240, 348, 399, 128, 404, 209, 360, 318, 57, 295, 20, 38, 129, 152, 60, 166, 380, 0, 358, 89, 65535, 360, 57, 169, 77, 13, 10, 108, 255, 361, 370, 143, 342, 102, 176, 70, 221, 76, 210, 365, 305, 157, 129, 293, 126, 56, 174, 360, 345, 13, 400, 105, 126, 350, 360, 233, 155, 76, 129, 199, 196, 380, 223, 97, 204, 187, 38, 165, 98, 340, 380, 312, 374, 341, 407, 129, 86, 375, 266, 198, 175, 395, 391, 317, 121, 53, 286 },
	{ 363, 58, 19, 68, 164, 169, 298, 47, 67, 56, 208, 169, 158, 134, 364, 158, 138, 307, 361, 38, 134, 180, 153, 339, 126, 255, 4, 308, 72, 148, 219, 114, 36, 312, 95, 286, 79, 113, 64, 1, 1, 312, 110, 325, 38, 237, 167, 25, 242, 249, 362, 12, 307, 63, 196, 239, 141, 173, 248, 407, 133, 230, 255, 181, 28, 62, 113, 135, 353, 360, 278, 240, 272, 21, 128, 209, 65535, 208, 208, 185, 121, 176, 365, 366, 256, 366, 124, 336, 389, 237, 316, 40, 375, 108 },
	{ 336, 339, 189, 383, 89, 82, 129, 249, 251, 249, 259, 355, 343, 4, 27, 163, 5, 121, 148, 70, 130, 350, 57, 100, 191, 200, 360, 70, 253, 354, 388, 165, 162, 306, 356, 101, 345, 108, 151, 141, 270, 358, 336, 371, 336, 366, 55, 180, 400, 193, 294, 306, 129, 383, 175, 62, 17, 360, 65, 38, 235, 51, 354, 357, 120, 162, 341, 33, 125, 358, 389, 133, 259, 65535, 65535, 258, 2, 105, 187, 222, 369, 342, 236, 84, 270, 155, 296, 311, 13, 140, 169, 366, 343, 361 },
	{ 309, 360, 108, 186, 215, 291, 51, 196, 121, 30, 336, 336, 193, 210, 383, 136, 141, 173, 346, 354, 124, 43, 128, 311, 361, 65535, 65535, 348, 330, 341, 267, 366, 38, 360, 344, 19, 366, 127, 30, 307, 203, 350, 135, 279, 395, 209, 240, 340, 106, 236, 350, 344, 331, 2, 366, 13, 98, 4, 135, 32, 346, 175, 362, 65535, 60, 54, 32, 340, 389, 231, 39, 340, 144, 33, 44, 390, 14, 222, 121, 41, 239, 56, 357, 407, 215, 89, 34, 360, 360, 325, 356, 26, 144, 354 },
	{ 148, 369, 10, 306, 251, 169, 159, 360, 320, 260, 254, 348, 84, 33, 335, 40, 121, 53, 369, 158, 77, 168, 397, 253, 13, 308, 254, 364, 136, 253, 39, 41, 175, 195, 321, 126, 300, 356, 336, 119, 200, 146, 313, 182, 159, 138, 164, 366, 33, 341, 337, 127, 77, 259, 261, 114, 321, 261, 145, 65535, 234, 252, 65535, 249, 305, 30, 86, 367, 205, 197, 75, 196, 101, 14, 337, 112, 336, 166, 92, 297, 179, 181, 357, 305, 76, 176, 191, 186, 352, 234, 331, 119, 200, 136 },
	{ 124, 336, 174, 130, 387, 361, 126, 392, 129, 351, 126, 317, 354, 132, 177, 121, 354, 272, 308, 340, 162, 336, 399, 140, 27, 8, 341, 193, 124, 392, 249, 341, 306, 72, 399, 240, 197, 92, 84, 49, 293, 104, 181, 300, 346, 356, 197, 258, 307, 125, 351, 238, 131, 352, 339, 193, 356, 387, 148, 291, 190, 362, 248, 169, 272, 313, 127, 13, 350, 89, 316, 235, 201, 125, 362, 345, 163, 25, 121, 186, 124, 171, 392, 360, 181, 352, 92, 297, 305, 288, 290, 325, 32, 162 },
	{ 310, 169, 315, 32, 171, 272, 248, 13, 113, 399, 111, 346, 362, 368, 85, 113, 5, 65535, 106, 59, 196, 365, 36, 221, 251, 251, 340, 173, 251, 124, 131, 131, 65535, 355, 340, 137, 375, 360, 80, 130, 136, 57, 120, 235, 20, 169, 258, 345, 320, 262, 158, 336, 124, 181, 43, 125, 258, 342, 4, 100, 313, 177, 343, 175, 139, 346, 198, 310, 161, 65535, 126, 328, 389, 147, 389, 129, 77, 23, 341, 139, 32, 136, 225, 196, 89, 13, 366, 65535, 304, 84, 356, 340, 366, 13 },
	{ 135, 400, 106, 222, 366, 305, 56, 391, 288, 254, 355, 265, 297, 183, 133, 244, 30, 169, 245, 332, 343, 312, 63, 336, 77, 136, 15, 134, 33, 13, 32, 225, 4, 367, 324, 340, 100, 203, 240, 1, 244, 38, 169, 356, 252, 242, 33, 167, 383, 341, 288, 13, 218, 187, 301, 90, 90, 89, 225, 400, 134, 141, 9, 373, 305, 89, 402, 360, 225, 314, 345, 122, 241, 169, 249, 148, 397, 23, 389, 340, 4, 177, 288, 242, 49, 32, 129, 344, 65535, 366, 391, 114, 334, 157 },
	{ 369, 240, 297, 92, 346, 89, 391, 89, 41, 57, 153, 112, 132, 98, 345, 320, 176, 249, 84, 289, 107, 76, 296, 177, 260, 334, 400, 148, 344, 320, 198, 126, 305, 14, 100, 397, 200, 135, 387, 272, 94, 169, 360, 131, 17, 242, 189, 167, 198, 281, 346, 173, 378, 132, 251, 253, 124, 404, 358, 129, 43, 371, 364, 68, 129, 336, 17, 200, 141, 148, 179, 65, 57, 246, 200, 130, 80, 99, 351, 355, 117, 358, 186, 341, 127, 171, 249, 362, 249, 121, 159, 356, 49, 334 },
	{ 36, 139, 191, 366, 367, 342, 210, 1, 316, 135, 125, 362, 53, 49, 352, 383, 248, 23, 259, 181, 13, 372, 337, 336, 369, 317, 340, 15, 249, 30, 187, 169, 240, 198, 358, 274, 131, 41, 37, 49, 345, 83, 232, 392, 207, 389, 385, 179, 138, 245, 181, 342, 345, 365, 389, 331, 389, 176, 100, 63, 169, 331, 37, 147, 165, 355, 265, 389, 387, 105, 249, 324, 160, 138, 122, 117, 126, 134, 183, 140, 2, 351, 82, 101, 89, 141, 400, 312, 176, 41, 85, 72, 251, 384 },
	{ 186, 45, 172, 108, 131, 63, 139, 65535, 387, 208, 380, 171, 163, 129, 244, 139, 258, 73, 45, 36, 182, 30, 139, 352, 193, 362, 387, 84, 313, 311, 346, 94, 53, 94, 304, 17, 270, 392, 346, 135, 252, 249, 41, 316, 392, 121, 92, 368, 256, 331, 141, 253, 255, 181, 406, 341, 139, 367, 167, 356, 175, 19, 30, 365, 4, 203, 51, 289, 321, 369, 171, 242, 58, 129, 17, 360, 267, 77, 101, 148, 181, 389, 360, 387, 121, 169, 358, 295, 389, 260, 181, 385, 216, 335 },
	{ 47, 400, 50, 181, 175, 336, 131, 252, 130, 129, 129, 145, 62, 91, 131, 373, 231, 176, 20, 12, 378, 240, 65535, 90, 161, 92, 113, 315, 94, 375, 347, 369, 137, 114, 372, 191, 366, 33, 215, 249, 294, 359, 34, 356, 126, 20, 111, 106, 352, 158, 1, 201, 330, 354, 358, 341, 209, 11, 295, 157, 360, 389, 400, 91, 135, 387, 162, 258, 129, 58, 89, 32, 129, 341, 63, 366, 100, 135, 259, 131, 132, 244, 191, 101, 340, 65535, 129, 139, 131, 241, 147, 254, 312, 6 },
	{ 95, 19, 191, 205, 53, 131, 279, 297, 33, 181, 248, 259, 243, 60, 343, 43, 70, 355, 361, 148, 369, 65535, 38, 133, 72, 67, 365, 367, 108, 368, 339, 270, 125, 136, 273, 314, 99, 398, 206, 358, 251, 179, 70, 143, 181, 130, 293, 391, 407, 102, 387, 259, 389, 136, 105, 70, 356, 155, 277, 110, 241, 387, 196, 330, 186, 55, 236, 334, 218, 136, 356, 84, 366, 401, 68, 131, 50, 208, 197, 332, 77, 297, 37, 362, 95, 182, 17, 319, 389, 42, 101, 195, 281, 288 },
	{ 171, 175, 366, 341, 249, 286, 347, 341, 15, 277, 139, 307, 15, 15, 297, 100, 101, 121, 84, 129, 163, 366, 237, 191, 382, 136, 215, 177, 360, 357, 336, 75, 252, 295, 121, 392, 352, 314, 359, 357, 340, 111, 194, 399, 356, 121, 366, 336, 73, 9, 352, 14, 329, 177, 189, 289, 369, 360, 366, 82, 310, 343, 141, 52, 65535, 60, 351, 341, 169, 121, 137, 121, 84, 65535, 305, 343, 389, 259, 121, 89, 407, 196, 389, 48, 387, 322, 249, 288, 341, 399, 341, 264, 318, 315 },
	{ 74, 130, 126, 226, 213, 357, 400, 261, 251, 200, 318, 249, 74, 191, 194, 396, 65535, 366, 313, 353, 198, 129, 92, 59, 122, 35, 75, 355, 399, 14, 86, 81, 1, 169, 179, 380, 325, 63, 161, 331, 89, 348, 190, 342, 253, 381, 70, 210, 95, 339, 249, 74, 10, 68, 36, 391, 134, 63, 352, 14, 385, 107, 280, 256, 259, 75, 62, 132, 21, 195, 19, 145, 389, 89, 89, 351, 197, 152, 75, 198, 58, 294, 367, 360, 310, 400, 38, 204, 162, 131, 63, 312, 355, 215 },
	{ 310, 240, 274, 307, 158, 191, 148, 201, 242, 37, 145, 175, 101, 324, 13, 260, 321, 82, 387, 291, 334, 328, 89, 93, 101, 169, 356, 240, 163, 169, 129, 378, 114, 104, 140, 65535, 90, 360, 246, 384, 173, 327, 43, 288, 194, 31, 226, 20, 314, 139, 7, 251, 83, 146, 326, 128, 5, 366, 388, 101, 148, 246, 20, 19, 368, 205, 315, 65, 304, 295, 352, 313, 13, 215, 240, 76, 147, 165, 80, 365, 37, 130, 210, 359, 59, 66, 361, 144, 392, 324, 69, 122, 260, 109 },
	{ 286, 66, 388, 282, 39, 316, 2, 272, 165, 162, 318, 150, 378, 169, 94, 77, 55, 184, 177, 144, 131, 164, 255, 139, 0, 252, 229, 11, 61, 148, 159, 101, 128, 237, 140, 315, 400, 254, 144, 305, 77, 30, 307, 124, 1, 180, 252, 84, 193, 203, 95, 140, 206, 177, 360, 130, 17, 15, 316, 189, 186, 364, 403, 352, 63, 347, 141, 248, 181, 75, 163, 248, 52, 252, 62, 128, 399, 360, 30, 15, 390, 293, 55, 389, 13, 400, 65535, 297, 182, 129, 89, 164, 148, 267 },
	{ 387, 129, 282, 216, 89, 264, 106, 133, 113, 341, 246, 67, 121, 364, 138, 367, 9, 387, 101, 70, 181, 259, 38, 305, 80, 389, 102, 350, 183, 19, 169, 121, 366, 343, 320, 340, 198, 2, 10, 46, 121, 77, 48, 193, 340, 358, 131, 362, 385, 177, 173, 133, 138, 366, 121, 181, 104, 65535, 68, 134, 169, 288, 169, 365, 92, 148, 58, 380, 236, 392, 352, 130, 355, 360, 389, 165, 340, 55, 343, 286, 392, 84, 101, 336, 366, 366, 58, 161, 360, 120, 55, 180, 130, 281 },
	{ 38, 65535, 7, 129, 125, 15, 186, 362, 381, 179, 361, 40, 7, 162, 360, 65, 240, 65, 259, 360, 306, 341, 257, 398, 14, 358, 322, 71, 148, 366, 361, 139, 366, 65535, 30, 206, 267, 135, 193, 234, 59, 250, 95, 149, 171, 37, 171, 131, 15, 41, 341, 13, 139, 76, 56, 10, 9, 182, 14, 163, 38, 385, 252, 272, 234, 240, 351, 142, 54, 135, 167, 400, 34, 305, 128, 165, 316, 231, 180, 132, 224, 65535, 67, 68, 58, 176, 221, 108, 158, 4, 255, 111, 249, 112 },
	{ 346, 114, 362, 148, 111, 77, 395, 219, 189, 280, 113, 272, 244, 65535, 251, 258, 129, 65535, 126, 95, 195, 89, 240, 274, 343, 113, 134, 99, 71, 361, 38, 111, 101, 148, 169, 365, 263, 380, 258, 176, 37, 365, 257, 130, 210, 389, 305, 259, 324, 160, 249, 133, 357, 204, 293, 385, 345, 340, 169, 41, 89, 252, 256, 249, 341, 366, 84, 108, 108, 360, 240, 322, 260, 334, 164, 195, 46, 270, 208, 89, 158, 148, 89, 307, 366, 365, 180, 258, 14, 65535, 255, 4, 189, 190 },
	{ 187, 367, 341, 38, 316, 235, 295, 125, 25, 242, 316, 341, 344, 390, 383, 299, 191, 239, 126, 234, 288, 128, 195, 32, 171, 199, 169, 72, 259, 88, 362, 256, 342, 295, 392, 366, 129, 72, 129, 131, 384, 400, 121, 257, 246, 56, 294, 407, 100, 169, 305, 322, 130, 14, 38, 152, 13, 343, 356, 260, 388, 369, 295, 93, 232, 290, 345, 256, 375, 254, 392, 276, 251, 331, 13, 58, 151, 367, 345, 387, 158, 125, 120, 100, 84, 169, 13, 38, 308, 199, 71, 181, 73, 106 },
	{ 65, 372, 62, 19, 162, 391, 366, 366, 39, 341, 219, 226, 43, 288, 360, 13, 390, 7, 83, 95, 181, 392, 375, 341, 290, 336, 195, 296, 25, 39, 195, 255, 218, 130, 258, 286, 13, 63, 252, 312, 134, 316, 341, 343, 196, 5, 169, 322, 341, 400, 23, 175, 401, 293, 120, 372, 48, 351, 271, 258, 132, 97, 129, 360, 176, 341, 392, 84, 131, 241, 114, 360, 196, 389, 249, 256, 358, 60, 89, 259, 138, 254, 174, 400, 372, 208, 385, 132, 38, 68, 92, 391, 360, 101 },
	{ 407, 331, 343, 201, 389, 356, 295, 37, 327, 167, 159, 237, 121, 320, 351, 110, 316, 165, 20, 133, 341, 139, 169, 354, 295, 55, 75, 257, 353, 51, 16, 9, 313, 131, 89, 252, 389, 89, 288, 169, 331, 130, 19, 314, 158, 253, 13, 343, 343, 129, 133, 172, 129, 47, 123, 38, 389, 65, 19, 389, 131, 67, 42, 390, 139, 76, 55, 241, 271, 219, 234, 341, 41, 141, 248, 82, 51, 392, 175, 32, 174, 404, 346, 389, 66, 65535, 350, 65535, 240, 121, 141, 289, 101, 405 },
	{ 99, 308, 389, 400, 256, 136, 366, 169, 337, 324, 129, 237, 84, 286, 361, 1, 279, 188, 36, 139, 9, 322, 400, 361, 366, 47, 339, 200, 367, 331, 397, 311, 140, 139, 186, 259, 40, 257, 183, 340, 372, 204, 4, 177, 10, 347, 365, 83, 5, 245, 216, 181, 308, 89, 120, 314, 106, 134, 336, 80, 129, 133, 344, 354, 98, 169, 171, 131, 295, 322, 107, 286, 124, 129, 256, 176, 402, 84, 159, 33, 101, 215, 216, 66, 295, 400, 85, 67, 77, 258, 89, 125, 14, 281 },
	{ 4, 249, 313, 104, 358, 166, 15, 353, 189, 200, 364, 106, 288, 406, 169, 56, 357, 56, 253, 189, 131, 139, 271, 100, 10, 134, 326, 153, 121, 63, 120, 95, 148, 13, 180, 250, 156, 17, 72, 193, 5, 356, 172, 345, 335, 38, 344, 356, 323, 317, 364, 15, 159, 191, 263, 322, 129, 400, 350, 260, 138, 17, 124, 174, 192, 126, 196, 129, 142, 392, 196, 249, 4, 291, 175, 57, 41, 365, 342, 360, 259, 72, 169, 256, 23, 2, 85, 365, 340, 356, 341, 258, 111, 380 }
};

int PinYinCmp( const char *str1, const char *str2 );
int GetNameType( BYTE cFirst );
int PinYinCmpEx(const char* pChn, const char * pEng);

//***************************************************************************************
//
//				other > English > Chinese
//
//***************************************************************************************
int NameCmp( char *pName1, char *pName2 )
{
	int i;
	int iRet;

	for( i=0, iRet=0; ( *pName1 && *pName2 ); i++ )
	{
		if(( BYTE )*pName1 > HROWCODESTART )					//1 is Chinese
		{
			if(( BYTE )*pName2 > HROWCODESTART )				//2 is Chinese too
			{
				if( pName1[1] && pName2[1] )
				{
					iRet = PinYinCmp( pName1++, pName2++ );		
				}
				else
				{
					return( tolower( *pName1 ) - tolower( *pName2 ));
				}
			}
			else
			{
				return -1;
			}
		}
		else if(( BYTE )*pName2 > HROWCODESTART )				//2 is Chinese, but 1 is English
		{
			return 1;
		}
		else													//both is English or other
		{
			if( GetNameType( *pName1 ) == GetNameType( *pName2 ))	//same type
			{
				iRet = tolower( *pName1 ) - tolower( *pName2 );
			}
			else													//different type
			{
				return ( GetNameType( *pName1 ) == CHARTYPE_OTHER )? 1: -1;
			}
		}
		if( iRet )
		{
			return iRet;
		}
		pName1++;
		pName2++;
	}

	return ( *pName1 )? 1: -1;
}

//***************************************************************************************
//
//				other > Chinese or English(if same, Chinese > English)
//
//***************************************************************************************
int NameCmpSe( char *pName1, char *pName2 )
{
	int i;
	int iRet;
    

	for( i=0, iRet=0; ( *pName1 && *pName2 ); i++ )
	{
		if(( BYTE )*pName1 > HROWCODESTART )					//1 is Chinese
		{
			if(( BYTE )*pName2 > HROWCODESTART )				//2 is Chinese too
			{
				if( pName1[1] && pName2[1] )
				{
					iRet = PinYinCmp( pName1++, pName2++ );		
				}
				else
				{
					return( tolower( *pName1 ) - tolower( *pName2 ));
				}
			}
			else if(GetNameType( *pName2 ) == CHARTYPE_LETTER)	//2 is English, but 1 is Chinese
			{
				return(PinYinCmpEx(pName1, pName2));
			}
            else
            {
                return -1;                                      //2 is other, but 1 is Chinese
            }
		}
		else if(( BYTE )*pName2 > HROWCODESTART )				//2 is Chinese, but 1 is English
		{
            if(GetNameType( *pName1 ) == CHARTYPE_OTHER)
            {
                //1为其它
                return 1;
            }
            iRet = PinYinCmpEx(pName2, pName1);
			return(-iRet);
		}
		else													//both is English or other
		{
			if( GetNameType( *pName1 ) == GetNameType( *pName2 ))	//same type
			{
				iRet = tolower( *pName1 ) - tolower( *pName2 );
			}
			else													//different type
			{
				return ( GetNameType( *pName1 ) == CHARTYPE_OTHER )? 1: -1;
			}
		}
		if( iRet )
		{
			return iRet;
		}
		pName1++;
		pName2++;
	}

	return ( *pName1 )? 1: -1;
}

//**************************************************************************************
//
//				Get Char Type
//
//**************************************************************************************
int GetNameType( BYTE cFirst )							
{
	if( cFirst > HROWCODESTART )
	{
		return CHARTYPE_CHN;							//Chinese
	}
	if(( cFirst >= ASCCHARCAPSTART && cFirst <= ASCCHARCAPEND )
		||( cFirst >= ASCCHARSTART && cFirst <= ASCCHAREND ))
	{
		return CHARTYPE_LETTER;							//English
	}
	return CHARTYPE_OTHER;								//Other
}


//***************************************************************************************
//
//	
//
//	
//
//	return：	the same as "strcmp"
//
//***************************************************************************************
int PinYinCmp( const char *str1, const char *str2 )
{
	BYTE bh, bl;
	int iPY1;
	int iPY2;

	bh = *str1++ - CNSEGBASE;
	bl = *str1 - CNOFFSETBASE;

	iPY1 = PYIndex[bh][bl];

	bh = *str2++ - CNSEGBASE;
	bl = *str2 - CNOFFSETBASE;

	iPY2 = PYIndex[bh][bl];

	return( iPY1 - iPY2 );
}

const char* GetPinYin(const char *str)
{
    BYTE bh, bl;
    int iPY;

    bh = *str++ - CNSEGBASE;
	bl = *str - CNOFFSETBASE;

    iPY = PYIndex[bh][bl];
    
    return (AllPY[iPY]);
}

//***************************************************************************************
//
//	
//
//	param：	pChn:string in Chinese
//			pEng:string in English
//
//	return：	the same as strcmp
//
//***************************************************************************************
int PinYinCmpEx(const char* pChn, const char * pEng)
{
    int i=0, iRet;
    const char* pString;

    while(*pChn++)
    {
        pString = GetPinYin(pChn-1);
        
        while(*pString)
        {
            iRet = tolower(*pString) - tolower(*pEng);

            if(iRet)
                return iRet;

            pString++;
            pEng++;
        }
        
        pChn++;
    }
    
    
    if(*pEng)
    {
        //chinese is over, english remain
        return -1;
    }
        
    //same, chinese is behind
    return 1;
}

//***************************************************************************************
//
//	功能：	从pSrc中模糊查询一个关键字串，规则：
//          如果pKey为中文，则pSrc中含有该字串为符合。
//          如果pKey为英文，则pSrc中含有该字串或者pKey为pSrc中某连续汉字的拼音，为符合            
//
//	参数：	分别指向一个汉字，一个英文字串
//
//	返回：	符合返回0，否则－1
//
//***************************************************************************************
int NameCmpHazy( char *pStringKey, char *pStringSrc )
{
    char* pPinYin;
    char* pKey;
    char* pSrc;

    while(*pStringSrc)
    {
        pKey = pStringKey;
        pSrc = pStringSrc;

        while(*pKey && *pSrc)
        {
            if(( BYTE )*pKey > HROWCODESTART && ( BYTE )*pSrc > HROWCODESTART)               
            {
                //both Chinese
                if(strncmp(pKey, pSrc, 2))
                    break;
                
                pKey += 2;
                pSrc += 2;
            }
            else if(( BYTE )*pKey < HROWCODESTART && ( BYTE )*pSrc < HROWCODESTART)
            {
                //both English
                if(tolower(*pKey) != tolower(*pSrc))
#ifdef _ANY_MATCH			//match if pKey in any position of the pSrc
                    break;
#else					    //match just if pKey in beginning of the pSrc
				    return -1;
#endif
                
                pKey++;
                pSrc++;
            }
            else if(( BYTE )*pKey < HROWCODESTART && ( BYTE )*pSrc > HROWCODESTART)
            {
                //key is English，src is Chinese
                pPinYin = (char*)GetPinYin(pSrc);
				if(strnicmp(pKey, pPinYin, strlen(pPinYin)) == 0)
				{
					pKey += strlen(pPinYin);
					pSrc +=2;
				}
				else
					break;

//                if(stricmp(pKey, pPinYin))
//                    break;
//                
//                pKey += strlen(pPinYin);
//                 pSrc +=2;
            }
            else
            {
                //key is Chinese，Src is English
                break;
                
                pKey +=2;
                pSrc++;
            }
        }

        if(*pKey == '\0')
            return 0;
        
        if(*pStringSrc > HROWCODESTART)
            pStringSrc += 2;
        else
            pStringSrc++;
    }

    return -1;
}

/*********************************************************************\
* Function	   
* Purpose      
* Params	   Array:
               cmpf:
               nCount
* Return	 	   
* Remarks	   
**********************************************************************/
BOOL AB_HeapSort(PVOID* Array, CMPFUNC cmpf, int nCount)
{
    int i;

    for(i = nCount/2; i >=1; i--)
        AB_SortTop(Array, cmpf, i, nCount);

    for(i = nCount; i > 1 ; i--)
    {
        Array[0] = Array[i];
        Array[i] = Array[1];
        Array[1] = Array[0];
        AB_SortTop(Array, cmpf, 1, i - 1);
    }
    return TRUE;
}

/*********************************************************************\
* Function	   
* Purpose      bulid heap
* Params	   nStart:root nMax:
* Return	 	   
* Remarks	   
**********************************************************************/
BOOL AB_SortTop(PVOID* Array, CMPFUNC cmpf, int nStart, int nMax)
{
    int parent, child;

    Array[0] = Array[nStart];

    for(parent = nStart, child = nStart<<1; child<=nMax;)
    {
        //compare the left child and right child,pick up the large
        if(child<nMax)
        {
            //two children
            if(cmpf(Array[child], Array[child+1]) < 0)
                child++; //right child is large
        }

        if(cmpf(Array[0], Array[child]) >=0)
            break;      

        Array[parent] = Array[child];

        //update
        parent = child;
        child = child << 1;
    }
    //change the parent
    if(parent != nStart)
    {
        Array[parent] = Array[0];
    }
    
    return TRUE;

}
/*********************************************************************\
* Function	   
* Purpose      
* Params	   
* Return	 	   
* Remarks	   
**********************************************************************/
int HalfComp(PVOID* Array, int start, int end, int index, CMPFUNC cmpf)
{
    int half;

    //assert(start >=0 && end >=0);
    
    if(start == end)
    {
        if((*cmpf)(Array[start], Array[index]) <= 0)
        {
            return start+1;
        }
        else
            return start;
    }

    if(end == start + 1)
    {
        if((*cmpf)(Array[start], Array[index]) >= 0)
        {
            return start;
        }
        else if((*cmpf)(Array[end], Array[index]) <= 0)
        {
            return end + 1;
        }
        else
            return end;
    }

    half = (start + end) / 2;
    
    if((*cmpf)(Array[half], Array[index]) == 0)
        return half+1;
    else if((*cmpf)(Array[half], Array[index]) > 0)
        return HalfComp(Array, start, half-1, index, cmpf);
    else
        return HalfComp(Array, half + 1, end, index, cmpf);
}
/*********************************************************************\
* Function	   
* Purpose      
* Params	   
* Return	 	   
* Remarks	   
**********************************************************************/
int AB_Compare_Name(PVOID index1, PVOID index2)
{    
    //assert(index1 < nName && index2 < nName);
#ifndef LANGUAGE_CHN
	return(stricmp(AB_GetNameString(index1),AB_GetNameString(index2)));
#else
	{
		char pName1[AB_MAXLEN_FIRSTNAME* 2 + 1];
		char pName2[AB_MAXLEN_FIRSTNAME* 2 + 1];
		
		MultiByteToUTF8(CP_ACP, 0, AB_GetNameString(index1), -1, pName1, AB_MAXLEN_FIRSTNAME*2);
		MultiByteToUTF8(CP_ACP, 0, AB_GetNameString(index2), -1, pName2, AB_MAXLEN_FIRSTNAME*2);

		return(NameCmpSe(pName1, pName2));
	}
#endif
}

/*********************************************************************\
* Function	   
* Purpose      
* Params	   
* Return	 	   
* Remarks	   
**********************************************************************/
int AB_Compare_Tel(PVOID index1, PVOID index2)
{
    //assert(index1 < nTel && index2 < nTel);

    return(stricmp(AB_GetTelEmailString(index1),AB_GetTelEmailString(index2)));
}

/*********************************************************************\
* Function	   
* Purpose      
* Params	   
* Return	 	   
* Remarks	   
**********************************************************************/
int AB_Compare_Email(PVOID index1, PVOID index2)
{
//    assert(index1 < nEmail && index2 < nEmail);

    return(stricmp(AB_GetTelEmailString(index1),AB_GetTelEmailString(index2)));
}
/*********************************************************************\
* Function	   
* Purpose      
* Params	   
* Return	 	   
* Remarks	   
**********************************************************************/
int AB_Compare_ID(PVOID index1, PVOID index2)
{
    //assert(index1 < nID && index2 < nID);

    if(((PMEMORY_NAME)index1)->id == ((PMEMORY_NAME)index2)->id)
        return 0;
    else if(((PMEMORY_NAME)index1)->id > ((PMEMORY_NAME)index2)->id)
        return 1;
    else 
        return -1;
}
/*********************************************************************\
* Function	   
* Purpose      
* Params	   
* Return	 	   
* Remarks	   
**********************************************************************/
char* AB_GetNameString(PVOID pMemory)
{
    return((LPBYTE)pMemory+sizeof(DWORD)*2+sizeof(int)+sizeof(BYTE));
}
/*********************************************************************\
* Function	   
* Purpose      
* Params	   
* Return	 	   
* Remarks	   
**********************************************************************/
char* AB_GetTelEmailString(PVOID pMemory)
{
    return((LPBYTE)pMemory+sizeof(DWORD)+sizeof(int)*2+sizeof(BYTE));
}

static BOOL IsExsitID(int* pID, int nMax, int id)
{
	int i;

	for(i=0; i<nMax; i++)
	{
		if(pID[i] == id)
			return TRUE;
	}

	return FALSE;
}

int AB_FindByTel(char* pszTel, int* pID, int nMax)
{
	int i, nCount = 0, code, nOver = 0;
	PMEMORY_TEL pTel;
	char* pStringComing;
	char* pStringExist;
	int len1, len2;

	len1 = strlen(pszTel);

	if( len1<= COMPARE_TEL_COUNT)
	{
		code = atoi(pszTel);
		pStringComing = pszTel;
	}
	else
	{
		pStringComing = pszTel + len1 - COMPARE_TEL_COUNT;
		code = atoi(pStringComing);
	}

	
	for(i = 1; i<= nTel; i++)
	{
		pTel = pIndexTel[i];

		if(pTel->TelCode == code)
		{
			pStringExist = AB_GetTelEmailString(pTel);
			len2 = strlen(pStringExist);

			if( len2> COMPARE_TEL_COUNT)
				pStringExist = pStringExist + len2 - COMPARE_TEL_COUNT;
			
			if(strcmp(pStringExist, pStringComing))
				continue;

//			if(len1 < COMPARE_TEL_COUNT && (len1 != len2))
//			{
//				//eg 1234000056  vs  56
//				continue;
//			}
//			
//			if(len1 >= COMPARE_TEL_COUNT && len2 < COMPARE_TEL_COUNT)
//			{
//				//eg 56 vs 000056
//				continue;
//			}			

			//ok, find one
			if(nCount < nMax)
			{
				if(!IsExsitID(pID, nCount, pTel->id))
				{
					pID[nCount] = pTel->id;
					nCount++;
				}
			}
			else
			{
				nOver++;
			}
			
		}
	}

	return nCount+nOver;
}


/*********************************************************************\
* Function	   Memory_Find
* Purpose      
* Params	   
* Return	 	   
* Remarks	   
**********************************************************************/
PVOID Memory_Find(PVOID pCompare,AB_FIND_TYPE nType)
{
    int nmiddle,nstart,nend;
    int nCmpRet;
     
    nstart = 1;
    switch(nType)
    {
    case AB_FIND_NAME:
        nend = nName;
        break;
        
    case AB_FIND_ID:
        nend = nID;
        break;
        
    case AB_FIND_TEL:
        nend = nTel;
        break;
        
    case AB_FIND_EMAIL:
        nend = nEmail;
        break;
        
    default:
        return NULL;
    }

    while(nend >= nstart)
    {
        nmiddle = (nend+nstart)/2;
        
        switch(nType)
        {
        case AB_FIND_NAME:
            nCmpRet = strcmp((char*)pCompare,AB_GetNameString(pIndexName[nmiddle]));
            
            if(nCmpRet == 0)
                return (PVOID)pIndexName[nmiddle];
            else if(nCmpRet > 0)
                nstart = nmiddle+1;
            else
                nend = nmiddle-1;
            break;

        case AB_FIND_ID:
            
            if( (DWORD)pCompare == ((PMEMORY_NAME)pIndexID[nmiddle])->id )
                nCmpRet = 0;
            else if((DWORD)pCompare > ((PMEMORY_NAME)pIndexID[nmiddle])->id)
                nCmpRet = 1;
            else 
                nCmpRet = -1;
            
            if(nCmpRet == 0)
                return (PVOID)pIndexID[nmiddle];
            else if(nCmpRet > 0)
                nstart = nmiddle+1;
            else
                nend = nmiddle-1;
            break;
            
        case AB_FIND_EMAIL:
            nCmpRet = strcmp((char*)pCompare,AB_GetTelEmailString(pIndexEmail[nmiddle]));
            
            if(nCmpRet == 0)
                return (PVOID)pIndexEmail[nmiddle];
            else if(nCmpRet > 0)
                nstart = nmiddle+1;
            else
                nend = nmiddle-1;
            break;
            
        case AB_FIND_TEL:
            nCmpRet = strcmp((char*)pCompare,AB_GetTelEmailString(pIndexTel[nmiddle]));
            
            if(nCmpRet == 0)
                return (PVOID)pIndexTel[nmiddle];
            else if(nCmpRet > 0)
                nstart = nmiddle+1;
            else
                nend = nmiddle-1;
            break;
            
        default:
            return NULL;
        }


        if(nCmpRet == 0)
        {
            switch(nType)
            {
            case AB_FIND_NAME:
                return (PVOID)pIndexID[nmiddle];

            case AB_FIND_ID:
                return (PVOID)pIndexName[nmiddle];
            
            case AB_FIND_EMAIL:
                return (PVOID)pIndexEmail[nmiddle];

            case AB_FIND_TEL:
                return (PVOID)pIndexTel[nmiddle];

            default:
                return NULL;
            }
        }
        else if(nCmpRet > 0)
            nstart = nmiddle+1;
        else
            nend = nmiddle-1;
    }

    return NULL;
}


BOOL AB_HasNumber(PVOID pItem)
{
	CONTACT_ITEMCHAIN* pTemp;

	pTemp = (CONTACT_ITEMCHAIN*)pItem;

	while(pTemp)
	{
		switch(pTemp->dwMask)
		{
		case AB_TYPEMASK_MOBILE:
		case AB_TYPEMASK_MOBILEHOME:
		case AB_TYPEMASK_MOBILEWORK:
		case AB_TYPEMASK_TEL:
		case AB_TYPEMASK_TELHOME:
		case AB_TYPEMASK_TELWORK:
			return TRUE;

		default:
			break;
		}

		pTemp = pTemp->pNext;
	}

	return FALSE;
}
